<%= turbo_frame_tag "event_drawer" do %>
  <div class="flex max-h-[85vh] flex-col">
    <% if flash.now[:notice].present? %>
      <div class="mb-3 rounded-xl border border-emerald-900/40 bg-emerald-950/30 p-3 text-sm text-emerald-200">
        <%= flash.now[:notice] %>
      </div>
    <% end %> 

    <!-- Header -->
    <div class="flex items-start justify-between border-b border-zinc-800 bg-zinc-950/50 px-6 py-4">
      <div>
        <div class="text-sm font-semibold text-zinc-100">Profile</div>
        <div class="text-xs text-zinc-500">Manage your account and preferences</div>
      </div>

      <button
        type="button"
        data-action="drawer#close"
        class="inline-flex items-center justify-center rounded-xl border border-zinc-950/40 bg-zinc-950/40 px-3 py-1.5 text-sm text-zinc-300 hover:border-zinc-500 transition">
        âœ•
      </button>
    </div>

    <!-- Body -->
    <div class="min-h-0 flex-1 overflow-hidden">
      <div class="grid h-full grid-cols-12">

        <!-- Left nav -->
        <aside class="col-span-3 border-r border-zinc-800 bg-zinc-950/30 p-4 overflow-y-auto flex flex-col">
          <div class="mb-3 flex items-center gap-3">
          </div>

          <div class="space-y-1">
            <a href="#account" class="block rounded-xl px-3 py-2 text-sm text-zinc-200 hover:bg-white/5 transition">
              My Account
            </a>
            <a href="#security" class="block rounded-xl px-3 py-2 text-sm text-zinc-200 hover:bg-white/5 transition">
              Data and Privacy
            </a>
            <a href="#preferences" class="block rounded-xl px-3 py-2 text-sm text-zinc-200 hover:bg-white/5 transition">
              Preferences
            </a>
          </div>

          <div class = "mt-auto"></div>
          <!-- sign out button -->
          <div class="mt-6 border-t border-zinc-800 pt-4">
            <%= button_to destroy_user_session_path,
                  method: :delete,
                  form: { data: { turbo: false } },
                  class: "w-full rounded-xl border border-zinc-800 bg-zinc-950/30 px-3 py-2 text-sm text-zinc-200 hover:bg-white/10 hover:border-white/20 hover:text-zinc-100 transition" do %>
              Sign out
            <% end %>
          </div>
        </aside>

        <!-- Right content -->
        <section class="col-span-8 p-6 overflow-y-auto space-y-8">

          <!-- Account -->
          <div id="security">
          <div class="text-xs font-semibold uppercase tracking-wide text-zinc-500">User Profile</div>
          <div class="mt-3 rounded-2xl border border-zinc-800 bg-zinc-900/40 p-5">
            
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <!-- avatar -->
                <div class="h-20 w-20 rounded-full overflow-hidden ring-2 ring-emerald-900/30 shadow-lg bg-zinc-900">
                  <% if user.avatar.attached? %>
                  <%= image_tag user.avatar,
                        class: "h-full w-full object-cover scale-200",
                        alt: "Profile avatar" %>
                  <% else %>
                  <%= image_tag "default_icon.png",
                        class: "h-full w-full object-cover scale-200",
                        alt: "Profile avatar" %>
                  <% end %>
                </div>



              </div>

                <div class="shrink-0">
                  <%= render Studs::SecondaryButtonComponent.new(label: "Change Icon", color: :blue, size: :xs) %>
                </div>
            </div>

            <div class="mt-4 border-t border-zinc-800/80 pt-4 space-y-4">
              <!-- Username row -->
              <div class="flex items-center justify-between gap-4">
                <div>
                  <div class="text-xs text-zinc-400">Username</div>
                  <div class="mt-1 text-sm font-medium text-zinc-100">
                    <%= user.email %>
                  </div>
                </div>

                <div class="shrink-0">
                  <%= render Studs::SecondaryButtonComponent.new(label: "Edit", color: :emerald, size: :xs) %>
                </div>
              </div>

              <!-- Email row -->
              <div class="flex items-center justify-between gap-4">
                <div>
                  <div class="text-xs text-zinc-400">Email</div>
                  <div class="mt-1 text-sm font-medium text-zinc-100">
                    <%= user.email %>
                  </div>
                </div>

                <div class="shrink-0">
                  <%= render Studs::SecondaryButtonComponent.new(label: "Edit", color: :emerald, size: :xs) %>
                </div>
              </div>
            </div>
            </div>
          </div>



          <!-- Security -->
          <div id="security">
            <div class="text-xs font-semibold uppercase tracking-wide text-zinc-500">Security</div>
            <div class="mt-3 rounded-2xl border border-zinc-800 bg-zinc-900/40 p-5 space-y-4">
              <div class="flex items-center justify-between gap-4">
                <!-- Password section -->
                <div>
                    <div class="text-sm text-zinc-200">Password</div>
                    <div class="text-xs text-zinc-500">Change the password you use to log in</div>
                </div>
                <div class="flex items-center justify-between gap-2">
                  <%= link_to edit_password_profile_path,
                      data: { turbo_frame: "event_drawer", turbo_prefetch: false } do %>
                  <%= render Studs::PrimaryButtonComponent.new(label: "Change password", color: :emerald) %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>

          <!-- Account Removal -->
          <div id="account removal">
            <div class="text-xs font-semibold uppercase tracking-wide text-zinc-500">Account Removal</div>
            <div class="mt-3 rounded-2xl border border-zinc-800 bg-zinc-900/40 p-5 space-y-4">
              <div class="flex items-center justify-between gap-4">
                <!-- Delete section -->
                <div>
                    <div class="text-sm text-zinc-200">Delete</div>
                    <div class="text-xs text-zinc-500">Delete your account</div>
                </div>
                <div class="flex items-center justify-between gap-2">
                  <%= link_to edit_password_profile_path,
                      data: { turbo_frame: "event_drawer", turbo_prefetch: false } do %>
                  <%= render Studs::PrimaryButtonComponent.new(label: "Delete Account", color: :red) %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>

        </section>
      </div>
    </div>

  </div>
<% end %>
