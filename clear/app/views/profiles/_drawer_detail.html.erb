<%= turbo_frame_tag "event_drawer" do %>
  <div class="flex max-h-[85vh] flex-col">
    <% if flash.now[:notice].present? %>
      <div class="mb-3 rounded-xl border border-emerald-900/40 bg-emerald-950/30 p-3 text-sm text-emerald-200">
        <%= flash.now[:notice] %>
      </div>
    <% end %> 

    <!-- Header -->
    <div class="flex items-start justify-between border-b border-zinc-800 bg-zinc-950/50 px-6 py-4">
      <div>
        <div class="text-sm font-semibold text-zinc-100">Profile</div>
        <div class="text-xs text-zinc-500">Manage your account and preferences</div>
      </div>

      <button
        type="button"
        data-action="drawer#close"
        class="inline-flex items-center justify-center rounded-xl border border-zinc-950/40 bg-zinc-950/40 px-3 py-1.5 text-sm text-zinc-300 hover:border-zinc-500 transition">
        ✕
      </button>
    </div>

    <!-- Body -->
    <div class="min-h-0 flex-1 overflow-hidden">
      <div class="grid h-full grid-cols-12">

        <!-- Left nav -->
        <aside class="col-span-3 border-r border-zinc-800 bg-zinc-950/30 p-4 overflow-y-auto flex flex-col">
          <div class="mb-3 flex items-center gap-3">
            <div class="h-10 w-10 rounded-xl border border-zinc-800 bg-zinc-900/60 flex items-center justify-center text-sm font-semibold text-zinc-100">
              <%= user.email.to_s.first&.upcase || "U" %>
            </div>
            <div class="min-w-0">
              <div class="text-xs text-zinc-500 truncate">Account</div>
              <div class="text-sm font-medium text-zinc-100 truncate"><%= user.email %></div>
            </div>
          </div>

          <div class="space-y-1">
            <a href="#account" class="block rounded-xl px-3 py-2 text-sm text-zinc-200 hover:bg-white/5 transition">
              Account
            </a>
            <a href="#security" class="block rounded-xl px-3 py-2 text-sm text-zinc-200 hover:bg-white/5 transition">
              Security
            </a>
            <a href="#preferences" class="block rounded-xl px-3 py-2 text-sm text-zinc-200 hover:bg-white/5 transition">
              Preferences
            </a>
          </div>

          <div class = "mt-auto"></div>
          <!-- sign out button -->
          <div class="mt-6 border-t border-zinc-800 pt-4">
            <%= button_to destroy_user_session_path,
                  method: :delete,
                  form: { data: { turbo: false } },
                  class: "w-full rounded-xl border border-zinc-800 bg-zinc-950/30 px-3 py-2 text-sm text-zinc-200 hover:bg-white/10 hover:border-white/20 hover:text-zinc-100 transition" do %>
              Sign out
            <% end %>
          </div>
        </aside>

        <!-- Right content -->
        <section class="col-span-8 p-6 overflow-y-auto space-y-8">

          <!-- Account -->
          <div id="account">
            <div class="text-xs font-semibold uppercase tracking-wide text-zinc-500">Account</div>
            <div class="mt-3 rounded-2xl border border-zinc-800 bg-zinc-900/40 p-5 space-y-4">

              <div>
                <div class="text-xs text-zinc-400">Email</div>
                <div class="mt-1 text-sm font-medium text-zinc-100"><%= user.email %></div>
              </div>

              <div class="grid gap-3 sm:grid-cols-2">
                <div class="sm:col-span-1">
                  <div class="text-xs text-zinc-400">Display name</div>
                  <div class="mt-2">
                    <%= render Studs::InputBoxComponent.new(
                      name: "user[name]",
                      placeholder: "Add a display name",
                      color: :zinc,
                      size: :xs
                    ) %>
                  </div>
                </div>
              </div>

              <div class="flex flex-wrap gap-2">
                <%= render Studs::PrimaryButtonComponent.new(label: "Save changes", color: :emerald) %>
              </div>
            </div>
          </div>

          <!-- Security -->
          <div id="security">
            <div class="text-xs font-semibold uppercase tracking-wide text-zinc-500">Security</div>
            <div class="mt-3 rounded-2xl border border-zinc-800 bg-zinc-900/40 p-5 space-y-4">
              <!-- Password section -->
              <div>
                  <div class="text-xs text-zinc-400">Password</div>
                  <div class="flex items-center justify-between gap-2">
                    <div class="mt-1 text-sm font-medium text-zinc-100">••••••••</div>
                    <button type="button" class="rounded-md p-1 text-zinc-400 hover:text-zinc-100 hover:bg-zinc-800/60 focus:outline-none focus:ring-2 focus:ring-emerald-500/40 transition">
                      <span id="icon-show">
                        <%= icon "eye-stroke-rounded", class: "h-5 w-5 text-emerald-500/40" %>
                      </span>

                      <span id="icon-hide" class="hidden">
                        <%= icon "view-off-slash-stroke-rounded", class: "h-5 w-5 text-emerald-500/40" %>
                      </span>  
                    </button>
                  </div>
                <div class="flex flex-wrap gap-2">
                  <%= link_to edit_password_profile_path,
                        data: { turbo_frame: "event_drawer", turbo_prefetch: false } do %>
                    <%= render Studs::PrimaryButtonComponent.new(label: "Change password", color: :emerald) %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>

          <!-- Preferences -->
          <div id="preferences">
            <div class="text-xs font-semibold uppercase tracking-wide text-zinc-500">Preferences</div>
            <div class="mt-3 rounded-2xl border border-zinc-800 bg-zinc-900/40 p-5 space-y-4">
              <div class="flex items-center justify-between gap-4">
                <div>
                  <div class="text-sm text-zinc-200">Start week on Monday</div>
                  <div class="text-xs text-zinc-500">Affects calendar views.</div>
                </div>
                <div class="flex items-center gap-2">
                  <input type="checkbox" class="h-4 w-4 rounded border-zinc-700 bg-zinc-950/40">
                </div>
              </div>

              <div class="flex items-center justify-between gap-4">
                <div>
                  <div class="text-sm text-zinc-200">Timezone</div>
                  <div class="text-xs text-zinc-500">Used for reminders and scheduling.</div>
                </div>
                <select class="rounded-xl border border-zinc-800 bg-zinc-950/40 px-3 py-2 text-sm text-zinc-200">
                  <option><%= Time.zone.name %></option>
                </select>
              </div>
            </div>
          </div>

        </section>
      </div>
    </div>

  </div>
<% end %>
