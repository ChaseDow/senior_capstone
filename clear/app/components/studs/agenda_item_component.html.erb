<%= content_tag(:div, **wrapper_attrs.merge(
  data: { agenda_item_card: true }.merge(wrapper_attrs[:data] || {}),
  style: merged_style,
  class: [wrapper_attrs[:class], "relative"].compact.join(" ")
)) do %>

  <% if @href.present? %>
    <%= link_to "",
      @href,
      class: "absolute inset-0 rounded-2xl z-0",
      aria: { label: "Open #{@title}" },
      data: {
        turbo_frame: (@turbo_frame.presence || "event_drawer"),
        turbo_prefetch: false,
        action: [
          (@open_action.presence),
          "click->agenda-drawer#close"
        ].compact.join(" ")
      } %>
  <% end %>

  <div class="relative z-10 flex items-start justify-between gap-3">
    <div class="min-w-0 flex-1">
      <div class="flex items-center gap-2">
        <span class="inline-flex h-2.5 w-2.5 rounded-full" style="background-color:<%= tint_bar %>"></span>

        <div class="truncate text-sm font-semibold text-zinc-50">
          <%= @title %>
        </div>

        <% if @tag.present? %>
          <span
            class="inline-flex items-center rounded-xl border px-2 py-0.5 text-xs font-semibold text-zinc-50"
            style="border-color:<%= tint_border %>; background-color:<%= rgba(@accent_color, 0.12) %>;">
            <%= @tag %>
          </span>
        <% end %>
      </div>

      <div class="mt-1 text-xs font-medium text-zinc-200/90">
        <%= @subline.presence || @time %>
      </div>

      <% if @meta.present? %>
        <div class="mt-1 truncate text-xs text-zinc-300/80"><%= @meta %></div>
      <% end %>
    </div>

    <% if @href.present? %>
      <%= link_to "Open",
        @href,
        class: "shrink-0 rounded-xl border px-3 py-1.5 text-xs font-semibold text-zinc-50 transition hover:brightness-110 relative z-20",
        style: "border-color: #{tint_border}; background-color: #{rgba(@accent_color, 0.18)};",
        data: {
          turbo_frame: (@turbo_frame.presence || "event_drawer"),
          turbo_prefetch: false,
          action: [
            (@open_action.presence),
            "click->agenda-drawer#close",
            "click->agenda-highlight#stopPropagation"
          ].compact.join(" ")
        } %>
    <% end %>
  </div>
<% end %>